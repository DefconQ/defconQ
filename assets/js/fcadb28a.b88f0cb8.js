"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1384],{32843:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var i=n(74848),a=n(28453);const s={sidebar_position:3},r="A Real Time Stock Market Feed",o={id:"tutorials/realTimeStocks",title:"A Real Time Stock Market Feed",description:"In this tutorial, we'll walk through building a real-time stock market data feed and streaming that data into a simplified KDB/Q Tick architecture. We'll use Python, specifically the yfinance library, to fetch live market data from Yahoo Finance, and then publish it to a custom KDB/Q Tickerplant (TP), which will forward the data to a Real-Time Database (RDB). We'll use the qpython library to connect our Feedhandler to the Tickerplant, enabling us to stream real-time data for further processing.",source:"@site/docs/tutorials/realTimeStocks.mdx",sourceDirName:"tutorials",slug:"/tutorials/realTimeStocks",permalink:"/docs/tutorials/realTimeStocks",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"KDB Tick Explained: A Walkthrough [PART 2]",permalink:"/docs/tutorials/tick2"},next:{title:"Back to the Future: Building Your Research HDB for Stock Market Insights",permalink:"/docs/tutorials/researchHDB"}},l={},c=[{value:"Who is this tutorial for?",id:"who-is-this-tutorial-for",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"What\u2019s in It for You: Skills You\u2019ll Master in This Tutorial",id:"whats-in-it-for-you-skills-youll-master-in-this-tutorial",level:2},{value:"Under the Hood: The Minimalist Tech Stack Powering It All",id:"under-the-hood-the-minimalist-tech-stack-powering-it-all",level:2},{value:"The Setup",id:"the-setup",level:2},{value:"Feedhandler",id:"feedhandler",level:3},{value:"<code>tickers.csv</code>: Your Command Center for Stock Selection",id:"tickerscsv-your-command-center-for-stock-selection",level:3},{value:"Table Schema and <code>sym.q</code> File",id:"table-schema-and-symq-file",level:3},{value:"Tickerplant (TP)",id:"tickerplant-tp",level:3},{value:"Real-Time Database (RDB)",id:"real-time-database-rdb",level:3},{value:"Bringing it all to Life: Launching Your Real-Time KDB/Q Stack",id:"bringing-it-all-to-life-launching-your-real-time-kdbq-stack",level:2},{value:"Resources",id:"resources",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"a-real-time-stock-market-feed",children:"A Real Time Stock Market Feed"}),"\n",(0,i.jsxs)(t.p,{children:["In this tutorial, we'll walk through building a real-time stock market data feed and streaming that data into a simplified KDB/Q Tick architecture. We'll use Python, specifically the ",(0,i.jsx)(t.a,{href:"https://github.com/ranaroussi/yfinance",children:(0,i.jsx)(t.code,{children:"yfinance"})})," library, to fetch live market data from Yahoo Finance, and then publish it to a custom KDB/Q Tickerplant (TP), which will forward the data to a Real-Time Database (RDB). We'll use the ",(0,i.jsx)(t.a,{href:"https://github.com/exxeleron/qPython/tree/master",children:(0,i.jsx)(t.code,{children:"qpython"})})," library to connect our Feedhandler to the Tickerplant, enabling us to stream real-time data for further processing."]}),"\n",(0,i.jsx)(t.p,{children:"While this setup has been simplified for educational purposes, it can be easily adapted to resemble a more production-ready environment."}),"\n",(0,i.jsx)(t.h2,{id:"who-is-this-tutorial-for",children:"Who is this tutorial for?"}),"\n",(0,i.jsx)(t.p,{children:"This tutorial is designed for anyone interested in building a real-time stock market data application. Whether you're a KDB/Q developer curious about the technical implementation, or a quantitative developer or researcher looking to set up a live data feed for analytics and strategy development, this guide is for you."}),"\n",(0,i.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(t.p,{children:["To get the most out of this tutorial, you should have a solid understanding of the KDB/Q Tick architecture. If you're unfamiliar with it, please check out ",(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/architecture/plain",children:"this dedicated blog post"}),". Additionally, a good understanding of how the Tickerplant works will be helpful, and I recommend reviewing my two in-depth tutorials that walk through the Plain Vanilla Tickerplant code line by line, which you can find ",(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/tutorials/tick",children:"here"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"whats-in-it-for-you-skills-youll-master-in-this-tutorial",children:"What\u2019s in It for You: Skills You\u2019ll Master in This Tutorial"}),"\n",(0,i.jsx)(t.p,{children:"In this tutorial, you\u2019ll learn how to build a simple yet powerful real-time stock data streaming application. Along the way, you\u2019ll get hands-on with the plain vanilla Tick architecture and deepen your understanding of key KDB/Q concepts like dictionaries, tables, attributes, and interprocess communication. You\u2019ll also explore how to work with various Python libraries and establish seamless connectivity between Python and KDB/Q."}),"\n",(0,i.jsx)(t.h2,{id:"under-the-hood-the-minimalist-tech-stack-powering-it-all",children:"Under the Hood: The Minimalist Tech Stack Powering It All"}),"\n",(0,i.jsx)(t.p,{children:"The tech stack behind this application is intentionally lightweight and focused, using just two core technologies."}),"\n",(0,i.jsx)(t.p,{children:"On the Python side, we use:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/ranaroussi/yfinance",children:(0,i.jsx)(t.code,{children:"yfinance"})})," to fetch real-time stock market data from Yahoo Finance"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/exxeleron/qPython/tree/master",children:(0,i.jsx)(t.code,{children:"qpython"})})," to connect Python to KDB/Q and stream data in real time"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"And of course, the backbone of the setup is KDB/Q. We\u2019ll build a streamlined Tickerplant and a real-time database using the simple tick library provided by KX."}),"\n",(0,i.jsx)(t.h2,{id:"the-setup",children:"The Setup"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"KDB/Q Real Time Stock Feed",src:n(3409).A+"",width:"741",height:"511"})}),"\n",(0,i.jsx)(t.p,{children:"The architecture of this application is fairly simple and consists of three main components:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"A Python-based Feedhandler that retrieves real-time stock data from Yahoo Finance and streams it to a KDB/Q Tickerplant"}),"\n",(0,i.jsx)(t.li,{children:"A custom KDB/Q Tickerplant that ingests the data and forwards it to the Real-Time Database (RDB)"}),"\n",(0,i.jsx)(t.li,{children:"A Real-Time Database that stores all intraday data in memory"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"In the following section, we\u2019ll take a closer look at each component of the setup, highlighting their key features and roles."}),"\n",(0,i.jsx)(t.h3,{id:"feedhandler",children:"Feedhandler"}),"\n",(0,i.jsxs)(t.p,{children:["As expected, the Python script for the Feedhandler is by far the longest, bringing to life the common joke: ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"\u201cFor every line of KDB/Q, you\u2019ll need at least 10 in a mainstream language like Python or Java.\u201d"})}),". Having worked almost exclusively with KDB/Q over the past decade, my Python skills are admittedly non existent and my friend Claude had to save the day. While LLMs still struggle to make sense of KDB/Q, thankfully they\u2019re fluent in Python. After a few back-and-forths, Claude managed to crank out a fully functioning Feedhandler."]}),"\n",(0,i.jsxs)(t.p,{children:["The Feedhandler uses the ",(0,i.jsx)(t.a,{href:"https://github.com/ranaroussi/yfinance",children:(0,i.jsx)(t.code,{children:"yfinance"})})," library to pull real-time stock market data from Yahoo Finance. You can specify which tickers you'd like to track by listing them in a CSV file, which the script reads on startup."]}),"\n",(0,i.jsx)(t.p,{children:"Due to rate limits imposed by Yahoo Finance, the script fetches data at 30-second intervals by default. This interval is configurable via a command-line argument or an environment variable."}),"\n",(0,i.jsxs)(t.p,{children:["To stream data from Python to KDB/Q, we use the ",(0,i.jsx)(t.a,{href:"https://github.com/exxeleron/qPython/tree/master",children:(0,i.jsx)(t.code,{children:"qpython"})})," library. While ",(0,i.jsx)(t.a,{href:"https://code.kx.com/pykx/3.1/",children:(0,i.jsx)(t.strong,{children:"PyKX"})})," would be a more modern alternative, it\u2019s currently only available under a ",(0,i.jsx)(t.a,{href:"https://code.kx.com/insights/1.13/enterprise/index.html",children:(0,i.jsx)(t.strong,{children:"KX Insights"})})," license, so for broader accessibility, we\u2019ve opted for ",(0,i.jsx)(t.code,{children:"qpython"}),". Since the library is a bit dated, there\u2019s a minor workaround needed when working with ",(0,i.jsx)(t.code,{children:"numpy"}),", but otherwise, the script is fairly straightforward and easy to follow."]}),"\n",(0,i.jsxs)(t.h3,{id:"tickerscsv-your-command-center-for-stock-selection",children:[(0,i.jsx)(t.code,{children:"tickers.csv"}),": Your Command Center for Stock Selection"]}),"\n",(0,i.jsxs)(t.p,{children:["To keep our application flexible and easy to configure, we use a simple CSV file, ",(0,i.jsx)(t.code,{children:"tickers.csv"}),", to define the list of stocks we want to track. Just add the relevant stock tickers to this file, and the Feedhandler will take it from there. This approach lets you quickly adjust your data feed without touching the code."]}),"\n",(0,i.jsxs)(t.h3,{id:"table-schema-and-symq-file",children:["Table Schema and ",(0,i.jsx)(t.code,{children:"sym.q"})," File"]}),"\n",(0,i.jsxs)(t.p,{children:["Before we dive into the Tickerplant code, let\u2019s take a moment to review the table schema for the data we\u2019re capturing. As you might recall (especially if you\u2019ve read my ",(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/tutorials/tick",children:"Tickerplant walkthrough"}),"), table schemas are stored in the ",(0,i.jsx)(t.code,{children:"sym.q"})," file, which the Tickerplant loads during initialization."]}),"\n",(0,i.jsx)(t.p,{children:"For this exercise, we\u2019ve defined the schema as follows:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"time"}),"\t\t\t: timestamp recorded by the Tickerplant"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"sym"}),"\t\t\t\t: ticker symbol of the stock"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"feedHandlerTime"}),"\t\t: timestamp from the Feedhandler"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"open, high, low, close"}),"\t: OHLC price data"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"volume"}),"\t\t\t: trading volume"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"bid, ask"}),"\t\t\t: bid and ask prices"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"bidSize, askSize"}),"\t\t: sizes at the bid and ask"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"A quick note"}),": we're capturing both the Tickerplant and Feedhandler timestamps. While this might not be critical in our educational example, it\u2019s a best practice in real-time systems\u2014especially when you want to measure latency between data ingestion points. To reinforce good KDB/Q practices, we apply the ",(0,i.jsx)(t.strong,{children:"sorted"})," ",(0,i.jsx)(t.code,{children:"s"})," attribute to the ",(0,i.jsx)(t.code,{children:"time"})," column and the ",(0,i.jsx)(t.code,{children:"grouped"})," attribute to the ",(0,i.jsx)(t.code,{children:"sym"})," column. If you're not familiar with attributes, or could use a refresher on how they work and why they matter, check out my dedicated post ",(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/concepts/attributes",children:"here"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"stocks:([] time:`s#`timestamp$(); `g#sym:`symbol$(); feedHandlerTime:`timestamp$(); open: `float$(); high:`float$(); low:`float$(); close:`float$(); volume:`int$(); bid:`float$(); ask:`float$(); bidSize:`int$(); askSize:`int$() )\n"})}),"\n",(0,i.jsx)(t.h3,{id:"tickerplant-tp",children:"Tickerplant (TP)"}),"\n",(0,i.jsxs)(t.p,{children:["The Tickerplant used in this setup is an even more lightweight version than the one featured in our ",(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/tutorials/tick",children:"Plain Vanilla Tick Setup walkthrough"}),". Since we're only fetching data every 30 seconds, there's no need to process each tick individually, instead, we'll run the Tickerplant in batch mode, publishing data on a pre-defined interval."]}),"\n",(0,i.jsxs)(t.p,{children:["We've also made a few tweaks to the ",(0,i.jsx)(t.code,{children:".u.upd"})," function to accommodate the structure of the incoming data. To understand how it works, we'll set a breakpoint in ",(0,i.jsx)(t.code,{children:".u.upd"}),", inspect the incoming messages, and step through the logic together."]}),"\n",(0,i.jsxs)(t.p,{children:["The section we're focusing on is shown below. We\u2019ll start the Tickerplant ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"without"})})," specifying a batch interval, which means the execution path will hit the ",(0,i.jsx)(t.code,{children:".u.upd"})," function defined here. At this point, we can set a breakpoint using ",(0,i.jsx)(t.code,{children:"'break"})," to pause execution and inspect the incoming data when the function is triggered."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'if[not system"t";system"t 1000";\n .z.ts:{ts .z.D};\n upd:{[t;x]\n ts"d"$a:.z.P;\n \'break;\n if[not -16=type first first x;a:"n"$a;x:$[0>type first x;a,x;(enlist(count first x)#a),x]];\n\n f:key flip value t;pub[`$t;$[0>type first x;enlist f!x;update `$sym,"P"$feedHandlerTimer from flip f!flip x:a,\'x]];if[l;l enlist (`upd;t;x);i+:1];}];\n'})}),"\n",(0,i.jsx)(t.admonition,{type:"tip",children:(0,i.jsxs)(t.p,{children:["To trigger a breakpoint, you can use the ",(0,i.jsx)(t.a,{href:"https://code.kx.com/q/ref/signal/",children:"signal"})," operator ",(0,i.jsx)(t.code,{children:"'"})," with any custom error message and are not limited to using ",(0,i.jsx)(t.code,{children:"break"})," as I did."]})}),"\n",(0,i.jsx)(t.p,{children:"After saving our changes, we launch the Tickerplant with the command:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"qq tick.q sym . -p 5010\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Once the Tickerplant is up and running, be sure to set the ",(0,i.jsx)(t.a,{href:"https://code.kx.com/q/basics/cmdline/#-e-error-traps",children:(0,i.jsx)(t.code,{children:"\\e"})})," flag to ",(0,i.jsx)(t.code,{children:"1"})," (true). This enables error trapping mode, allowing us to inspect the internal state and debug more effectively."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'alexanderunterrainer@Mac:~/repos/yfinData|\u21d2  qq tick.q sym . -p 5010\nKDB+ 4.1 2025.02.18 Copyright (C) 1993-2025 Kx Systems\nm64/ 8(24)core 24576MB alexanderunterrainer mac 192.168.1.177 EXPIRE 2026.03.11 KDB PLUS PERSONAL #5024911\n\nq).u.upd\n{[t;x]\n ts"d"$a:.z.P;\n \'break;\n if[not -16=type first first x;a:"n"$a;x:$[0>type first x;a,x;(enlist(count first x)#a),x]];\n\n f:key flip value t;pub[`$t;$[0>type first x;enlist f!x;update `$sym,"P"$feedHandlerTimer from flip f!flip x:a,\'x]];if[l;l enlist (`upd;t;x);i+:1];}\nq)\\e 1\nq)\\e\n1i\nq)\n'})}),"\n",(0,i.jsxs)(t.p,{children:["Now let\u2019s fire up the Python Feedhandler and watch the magic happen as our code ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:'"breaks"'})})," precisely where we intended."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'q)\'break\n  [0]  /Users/alexanderunterrainer/repos/yfinData/tick.q:45: .u.upd:\n ts"d"$a:.z.P;\n \'break;\n  ^\n if[not -16=type first first x;a:"n"$a;x:$[0>type first x;a,x;(enlist(count first x)#a),x]];\nq.u))\n'})}),"\n",(0,i.jsxs)(t.p,{children:["Based on our function definition, we know that ",(0,i.jsx)(t.code,{children:".u.upd"})," accepts two arguments: ",(0,i.jsx)(t.code,{children:"t"}),", the table name, and ",(0,i.jsx)(t.code,{children:"x"}),", the data to be streamed to all real-time subscribers. Let\u2019s take a closer look at the data being received."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'q)\'break\n  [0]  /Users/alexanderunterrainer/repos/yfinData/tick.q:45: .u.upd:\n ts"d"$a:.z.P;\n \'break;\n  ^\n if[not -16=type first first x;a:"n"$a;x:$[0>type first x;a,x;(enlist(count first x)#a),x]];\nq.u))t\n"stocks"\nq.u))x\n"AMZN"  "2025.05.18D10:22:20.279" 206.85 206.85 204.37 205.59 43072700  205.49 205.77 3  3\n"GOOGL" "2025.05.18D10:22:20.279" 167.73 169.35 165.62 166.19 42650100  166.14 166.26 7  7\n"HD"    "2025.05.18D10:22:20.279" 380.23 381.17 378.15 380.78 3127300   377.36 379.6  8  8\n"JNJ"   "2025.05.18D10:22:20.279" 149.67 151.5  149.22 151.33 8046000   151.1  151.1  8  9\n"JPM"   "2025.05.18D10:22:20.279" 267.5  268.46 264.71 267.56 8925900   264.5  266.01 12 8\n"MA"    "2025.05.18D10:22:20.279" 580.43 584.29 580.43 583.28 2225400   578.78 584.29 11 8\n"META"  "2025.05.18D10:22:20.279" 637.96 640.44 626.15 640.34 18405900  639.55 640.95 1  1\n"MSFT"  "2025.05.18D10:22:20.279" 452.05 454.36 448.73 454.27 23803400  443.32 454.45 1  2\n"NVDA"  "2025.05.18D10:22:20.279" 136.22 136.35 133.46 135.4  222651500 126.78 137f   1  2\n"PG"    "2025.05.18D10:22:20.279" 162.65 163.43 161.85 163.28 7100200   163.17 163.49 9  8\n"TSLA"  "2025.05.18D10:22:20.279" 346.24 351.62 342.33 349.98 93811800  328.7  363.64 1  1\n"UNH"   "2025.05.18D10:22:20.279" 279.29 294.49 269.14 291.91 70637700  287.57 287.7  8  14\n"V"     "2025.05.18D10:22:20.279" 362.95 366.19 360.89 365.12 5836500   363.55 365.25 8  9\n"WMT"   "2025.05.18D10:22:20.279" 96.14  99.19  96f    98.24  33708300  96.51  97.78  13 22\nq.u))type x\n0h\nq.u))type first x\n0h\nq.u))first x\n"AMZN"\n"2025.05.18D10:22:20.279"\n206.85\n206.85\n204.37\n205.59\n43072700\n205.49\n205.77\n3\n3\nq.u))\n'})}),"\n",(0,i.jsxs)(t.p,{children:["As shown above, the data sent by the Feedhandler is a mixed list of mixed lists. We can verify this by applying the ",(0,i.jsx)(t.a,{href:"https://code.kx.com/q/ref/type/",children:(0,i.jsx)(t.code,{children:"type"})})," operator to the entire dataset as well as to its first element, both return ",(0,i.jsx)(t.code,{children:"0h"}),", indicating a mixed list."]}),"\n",(0,i.jsx)(t.p,{children:"Since our table schema includes a Tickerplant timestamp, the first step is to prepend this timestamp to each row of incoming data. Here's how we can do that:"}),"\n",(0,i.jsxs)(t.p,{children:["From the first line of our ",(0,i.jsx)(t.code,{children:".u.upd"})," function, we know that the current timestamp, retrieved using ",(0,i.jsx)(t.code,{children:".z.P"}),", s stored in the variable ",(0,i.jsx)(t.code,{children:"a"}),". We can now use this variable to append the timestamp to each record in the mixed list. To do this, we use the ",(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/concepts/iterators#binary-opplication-of-each",children:(0,i.jsx)(t.strong,{children:"each-both"})})," ",(0,i.jsx)(t.code,{children:"'"})," iterator along with the concatenate operator ",(0,i.jsx)(t.code,{children:","}),". Thanks to atomic extension, and the fact that we\u2019re adding the ",(0,i.jsx)(t.strong,{children:"same"})," timestamp to every record, we can simply use a single timestamp atom, rather than generating a list of timestamps matching the length of our dataset."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'q.u))a\n2025.05.18D10:22:23.548140000\nq.u))a,\'x\n2025.05.18D10:22:23.548140000 "AMZN"  "2025.05.18D10:22:20.279" 206.85 206.85 204.37 205.59 43072700  205.49 205.77 3  3\n2025.05.18D10:22:23.548140000 "GOOGL" "2025.05.18D10:22:20.279" 167.73 169.35 165.62 166.19 42650100  166.14 166.26 7  7\n2025.05.18D10:22:23.548140000 "HD"    "2025.05.18D10:22:20.279" 380.23 381.17 378.15 380.78 3127300   377.36 379.6  8  8\n2025.05.18D10:22:23.548140000 "JNJ"   "2025.05.18D10:22:20.279" 149.67 151.5  149.22 151.33 8046000   151.1  151.1  8  9\n2025.05.18D10:22:23.548140000 "JPM"   "2025.05.18D10:22:20.279" 267.5  268.46 264.71 267.56 8925900   264.5  266.01 12 8\n2025.05.18D10:22:23.548140000 "MA"    "2025.05.18D10:22:20.279" 580.43 584.29 580.43 583.28 2225400   578.78 584.29 11 8\n2025.05.18D10:22:23.548140000 "META"  "2025.05.18D10:22:20.279" 637.96 640.44 626.15 640.34 18405900  639.55 640.95 1  1\n2025.05.18D10:22:23.548140000 "MSFT"  "2025.05.18D10:22:20.279" 452.05 454.36 448.73 454.27 23803400  443.32 454.45 1  2\n2025.05.18D10:22:23.548140000 "NVDA"  "2025.05.18D10:22:20.279" 136.22 136.35 133.46 135.4  222651500 126.78 137f   1  2\n2025.05.18D10:22:23.548140000 "PG"    "2025.05.18D10:22:20.279" 162.65 163.43 161.85 163.28 7100200   163.17 163.49 9  8\n2025.05.18D10:22:23.548140000 "TSLA"  "2025.05.18D10:22:20.279" 346.24 351.62 342.33 349.98 93811800  328.7  363.64 1  1\n2025.05.18D10:22:23.548140000 "UNH"   "2025.05.18D10:22:20.279" 279.29 294.49 269.14 291.91 70637700  287.57 287.7  8  14\n2025.05.18D10:22:23.548140000 "V"     "2025.05.18D10:22:20.279" 362.95 366.19 360.89 365.12 5836500   363.55 365.25 8  9\n2025.05.18D10:22:23.548140000 "WMT"   "2025.05.18D10:22:20.279" 96.14  99.19  96f    98.24  33708300  96.51  97.78  13 22\n'})}),"\n",(0,i.jsx)(t.p,{children:"With all the necessary data in place, the final step is to transform it into a proper KDB/Q table:"}),"\n",(0,i.jsxs)(t.p,{children:["We start by transposing the dataset using the ",(0,i.jsx)(t.a,{href:"https://code.kx.com/q/ref/flip/",children:(0,i.jsx)(t.code,{children:"flip"})})," operator. This restructures the mixed list so that each inner list now represents a column: the first list contains the Tickerplant timestamps, the second is a list of ticker symbols (as character strings), the third holds the Feedhandler timestamps, followed by lists of price data, volume, bid/ask prices, and sizes."]}),"\n",(0,i.jsxs)(t.p,{children:["Next, we use this transposed structure to build a column dictionary, aligning each list with the corresponding column name from our stock table schema defined in ",(0,i.jsx)(t.code,{children:"sym.q"}),", which the Tickerplant loads during initialization. From there, it\u2019s simple: a KDB/Q table is just a flipped column dictionary. So all that remains is one final ",(0,i.jsx)(t.code,{children:"flip"})," to produce the fully structured stock data table."]}),"\n",(0,i.jsx)(t.admonition,{type:"tip",children:(0,i.jsxs)(t.p,{children:["If you need a refresher on KDB/Q dictionaries or tables, and how to create, update, or manipulate them, check out my post ",(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/concepts/dictionariesTables",children:"here"})]})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'q.u))flip a,\'x\n2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000..\n"AMZN"                        "GOOGL"                       "HD"                          "JNJ"                         "JPM"                         "MA"                          "META"                        "MSFT"                       ..\n"2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"    ..\n206.85                        167.73                        380.23                        149.67                        267.5                         580.43                        637.96                        452.05                       ..\n206.85                        169.35                        381.17                        151.5                         268.46                        584.29                        640.44                        454.36                       ..\n204.37                        165.62                        378.15                        149.22                        264.71                        580.43                        626.15                        448.73                       ..\n205.59                        166.19                        380.78                        151.33                        267.56                        583.28                        640.34                        454.27                       ..\n43072700                      42650100                      3127300                       8046000                       8925900                       2225400                       18405900                      23803400                     ..\n205.49                        166.14                        377.36                        151.1                         264.5                         578.78                        639.55                        443.32                       ..\n205.77                        166.26                        379.6                         151.1                         266.01                        584.29                        640.95                        454.45                       ..\n3                             7                             8                             8                             12                            11                            1                             1                            ..\n3                             7                             8                             9                             8                             8                             1                             2                            ..\nq.u))`time`sym`feedHandlerTime`open`high`low`close`volume`bid`ask`bidSize`askSize!flip a,\'x\ntime           | 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D10:22:23.548140000 2025.05.18D1..\nsym            | "AMZN"                        "GOOGL"                       "HD"                          "JNJ"                         "JPM"                         "MA"                          "META"                        "MSFT"      ..\nfeedHandlerTime| "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D10:22:20.279"     "2025.05.18D..\nopen           | 206.85                        167.73                        380.23                        149.67                        267.5                         580.43                        637.96                        452.05      ..\nhigh           | 206.85                        169.35                        381.17                        151.5                         268.46                        584.29                        640.44                        454.36      ..\nlow            | 204.37                        165.62                        378.15                        149.22                        264.71                        580.43                        626.15                        448.73      ..\nclose          | 205.59                        166.19                        380.78                        151.33                        267.56                        583.28                        640.34                        454.27      ..\nvolume         | 43072700                      42650100                      3127300                       8046000                       8925900                       2225400                       18405900                      23803400    ..\nbid            | 205.49                        166.14                        377.36                        151.1                         264.5                         578.78                        639.55                        443.32      ..\nask            | 205.77                        166.26                        379.6                         151.1                         266.01                        584.29                        640.95                        454.45      ..\nbidSize        | 3                             7                             8                             8                             12                            11                            1                             1           ..\naskSize        | 3                             7                             8                             9                             8                             8                             1                             2           ..\nq.u))flip `time`sym`feedHandlerTime`open`high`low`close`volume`bid`ask`bidSize`askSize!flip a,\'x\ntime                          sym     feedHandlerTime           open   high   low    close  volume    bid    ask    bidSize askSize\n-----------------------------------------------------------------------------------------------------------------------------------\n2025.05.18D10:22:23.548140000 "AMZN"  "2025.05.18D10:22:20.279" 206.85 206.85 204.37 205.59 43072700  205.49 205.77 3       3\n2025.05.18D10:22:23.548140000 "GOOGL" "2025.05.18D10:22:20.279" 167.73 169.35 165.62 166.19 42650100  166.14 166.26 7       7\n2025.05.18D10:22:23.548140000 "HD"    "2025.05.18D10:22:20.279" 380.23 381.17 378.15 380.78 3127300   377.36 379.6  8       8\n2025.05.18D10:22:23.548140000 "JNJ"   "2025.05.18D10:22:20.279" 149.67 151.5  149.22 151.33 8046000   151.1  151.1  8       9\n2025.05.18D10:22:23.548140000 "JPM"   "2025.05.18D10:22:20.279" 267.5  268.46 264.71 267.56 8925900   264.5  266.01 12      8\n2025.05.18D10:22:23.548140000 "MA"    "2025.05.18D10:22:20.279" 580.43 584.29 580.43 583.28 2225400   578.78 584.29 11      8\n2025.05.18D10:22:23.548140000 "META"  "2025.05.18D10:22:20.279" 637.96 640.44 626.15 640.34 18405900  639.55 640.95 1       1\n2025.05.18D10:22:23.548140000 "MSFT"  "2025.05.18D10:22:20.279" 452.05 454.36 448.73 454.27 23803400  443.32 454.45 1       2\n2025.05.18D10:22:23.548140000 "NVDA"  "2025.05.18D10:22:20.279" 136.22 136.35 133.46 135.4  222651500 126.78 137    1       2\n2025.05.18D10:22:23.548140000 "PG"    "2025.05.18D10:22:20.279" 162.65 163.43 161.85 163.28 7100200   163.17 163.49 9       8\n2025.05.18D10:22:23.548140000 "TSLA"  "2025.05.18D10:22:20.279" 346.24 351.62 342.33 349.98 93811800  328.7  363.64 1       1\n2025.05.18D10:22:23.548140000 "UNH"   "2025.05.18D10:22:20.279" 279.29 294.49 269.14 291.91 70637700  287.57 287.7  8       14\n2025.05.18D10:22:23.548140000 "V"     "2025.05.18D10:22:20.279" 362.95 366.19 360.89 365.12 5836500   363.55 365.25 8       9\n2025.05.18D10:22:23.548140000 "WMT"   "2025.05.18D10:22:20.279" 96.14  99.19  96     98.24  33708300  96.51  97.78  13      22\nq.u))\n'})}),"\n",(0,i.jsxs)(t.p,{children:["If you were paying close attention, you may have noticed that the ",(0,i.jsx)(t.code,{children:"sym"})," and ",(0,i.jsx)(t.code,{children:"feedHandlerTime"})," columns are of type ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"string"})})," i.e., lists of characters) instead of ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"symbol"})})," and ",(0,i.jsx)(t.em,{children:(0,i.jsx)(t.strong,{children:"timestamp"})}),", respectively. Fortunately, we can easily correct this with a simple update statement:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'q.u))update `$sym,"P"$feedHandlerTime from flip `time`sym`feedHandlerTime`open`high`low`close`volume`bid`ask`bidSize`askSize!flip a,\'x\ntime                          sym   feedHandlerTime               open   high   low    close  volume    bid    ask    bidSize askSize\n-------------------------------------------------------------------------------------------------------------------------------------\n2025.05.18D10:22:23.548140000 AMZN  2025.05.18D10:22:20.279000000 206.85 206.85 204.37 205.59 43072700  205.49 205.77 3       3\n2025.05.18D10:22:23.548140000 GOOGL 2025.05.18D10:22:20.279000000 167.73 169.35 165.62 166.19 42650100  166.14 166.26 7       7\n2025.05.18D10:22:23.548140000 HD    2025.05.18D10:22:20.279000000 380.23 381.17 378.15 380.78 3127300   377.36 379.6  8       8\n2025.05.18D10:22:23.548140000 JNJ   2025.05.18D10:22:20.279000000 149.67 151.5  149.22 151.33 8046000   151.1  151.1  8       9\n2025.05.18D10:22:23.548140000 JPM   2025.05.18D10:22:20.279000000 267.5  268.46 264.71 267.56 8925900   264.5  266.01 12      8\n2025.05.18D10:22:23.548140000 MA    2025.05.18D10:22:20.279000000 580.43 584.29 580.43 583.28 2225400   578.78 584.29 11      8\n2025.05.18D10:22:23.548140000 META  2025.05.18D10:22:20.279000000 637.96 640.44 626.15 640.34 18405900  639.55 640.95 1       1\n2025.05.18D10:22:23.548140000 MSFT  2025.05.18D10:22:20.279000000 452.05 454.36 448.73 454.27 23803400  443.32 454.45 1       2\n2025.05.18D10:22:23.548140000 NVDA  2025.05.18D10:22:20.279000000 136.22 136.35 133.46 135.4  222651500 126.78 137    1       2\n2025.05.18D10:22:23.548140000 PG    2025.05.18D10:22:20.279000000 162.65 163.43 161.85 163.28 7100200   163.17 163.49 9       8\n2025.05.18D10:22:23.548140000 TSLA  2025.05.18D10:22:20.279000000 346.24 351.62 342.33 349.98 93811800  328.7  363.64 1       1\n2025.05.18D10:22:23.548140000 UNH   2025.05.18D10:22:20.279000000 279.29 294.49 269.14 291.91 70637700  287.57 287.7  8       14\n2025.05.18D10:22:23.548140000 V     2025.05.18D10:22:20.279000000 362.95 366.19 360.89 365.12 5836500   363.55 365.25 8       9\n2025.05.18D10:22:23.548140000 WMT   2025.05.18D10:22:20.279000000 96.14  99.19  96     98.24  33708300  96.51  97.78  13      22\n'})}),"\n",(0,i.jsxs)(t.p,{children:["To verify that the column types have been updated correctly, we can inspect the table schema using the ",(0,i.jsx)(t.a,{href:"https://code.kx.com/q/ref/meta/",children:(0,i.jsx)(t.code,{children:"meta"})})," operator."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'q.u))meta update `$sym,"P"$feedHandlerTime from flip `time`sym`feedHandlerTime`open`high`low`close`volume`bid`ask`bidSize`askSize!flip a,\'x\nc              | t f a\n---------------| -----\ntime           | p\nsym            | s\nfeedHandlerTime| p\nopen           | f\nhigh           | f\nlow            | f\nclose          | f\nvolume         | j\nbid            | f\nask            | f\nbidSize        | j\naskSize        | j\n'})}),"\n",(0,i.jsx)(t.p,{children:"It's important to note that type conversions like the one above should not be performed at the Tickerplant level. This approach is tailored to a very specific dataset and goes against the principle of keeping the Tickerplant generic and adaptable to various data sources."}),"\n",(0,i.jsx)(t.p,{children:"Ideally, the Tickerplant should remain as lightweight as possible, free of any dataset-specific business logic. A more appropriate place to handle this kind of transformation would be within the Feedhandler itself."}),"\n",(0,i.jsx)(t.p,{children:"That said, for illustrative and educational purposes, we'll keep the code as-is for now."}),"\n",(0,i.jsxs)(t.p,{children:["Now, returning to our Tickerplant code, we make a few final adjustments, cleaning up anything unnecessary, before it's ready to run. You can find the final version of the code in my GitHub repo ",(0,i.jsx)(t.a,{href:"https://github.com/DefconQ/defconQ/tree/master/projects/realTimeStock",children:"here"}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"real-time-database-rdb",children:"Real-Time Database (RDB)"}),"\n",(0,i.jsxs)(t.p,{children:["For the Real-Time Database (RDB), only minimal adjustments are needed. The main change is modifying the end-of-day save-down process: instead of persisting data to disk, which isn\u2019t necessary for our current setup, we simply purge the data from the ",(0,i.jsx)(t.code,{children:"stocks"})," table and start fresh the next day. We'll cover building a Historical Database (HDB) in a later stage."]}),"\n",(0,i.jsx)(t.h2,{id:"bringing-it-all-to-life-launching-your-real-time-kdbq-stack",children:"Bringing it all to Life: Launching Your Real-Time KDB/Q Stack"}),"\n",(0,i.jsx)(t.p,{children:"Now that all the pieces are in place, it\u2019s time to bring your real-time application to life."}),"\n",(0,i.jsx)(t.p,{children:"We\u2019ll start by launching the Tickerplant with the following command:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"qq tick.q sym . -p 5010\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Once it\u2019s up and running, you can verify that the ",(0,i.jsx)(t.code,{children:"stocks"})," table was correctly initialized by inspecting its contents and checking the schema using ",(0,i.jsx)(t.code,{children:"meta"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"alexanderunterrainer@Mac:~/repos/yfinData|\u21d2  qq tick.q sym . -p 5010\nKDB+ 4.1 2025.02.18 Copyright (C) 1993-2025 Kx Systems\nm64/ 8(24)core 24576MB alexanderunterrainer mac 192.168.1.177 EXPIRE 2026.03.11 KDB PLUS PERSONAL #5024911\n\nq)stocks\ntime sym feedHandlerTime open high low close volume bid ask bidSize askSize\n---------------------------------------------------------------------------\nq)meta stocks\nc              | t f a\n---------------| -----\ntime           | p   s\nsym            | s   g\nfeedHandlerTime| p\nopen           | f\nhigh           | f\nlow            | f\nclose          | f\nvolume         | i\nbid            | f\nask            | f\nbidSize        | i\naskSize        | i\n"})}),"\n",(0,i.jsx)(t.p,{children:"Next, start the Real-Time Database (RDB):"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"qq tick/r.q :5010 -p 5011\n"})}),"\n",(0,i.jsx)(t.p,{children:"Again, confirm that everything is wired up properly by reviewing the data and table schema."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"alexanderunterrainer@Mac:~/repos/yfinData|\u21d2  qq tick/r.q :5010 -p 5011\nKDB+ 4.1 2025.02.18 Copyright (C) 1993-2025 Kx Systems\nm64/ 8(24)core 24576MB alexanderunterrainer mac 192.168.1.177 EXPIRE 2026.03.11 KDB PLUS PERSONAL #5024911\n\nq)stocks\ntime sym feedHandlerTime open high low close volume bid ask bidSize askSize\n---------------------------------------------------------------------------\n"})}),"\n",(0,i.jsx)(t.p,{children:"Finally, kick off the Feedhandler, which will fetch stock data from Yahoo Finance every 30 seconds and stream it to the Tickerplant:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"alexanderunterrainer@Mac:~/repos/yfinData|\u21d2  python3 yahoo_finance_streamer.py --tickers tickers.csv\n2025-05-19 20:41:22,555 - INFO - Loaded 14 ticker symbols from tickers.csv\n2025-05-19 20:41:22,555 - INFO - Connecting to KDB+ at localhost:5010 (attempt 1/3)\n2025-05-19 20:41:22,556 - INFO - Successfully connected to KDB+: 3\n2025-05-19 20:41:22,556 - INFO - Starting data streaming for 14 symbols at 30s intervals\n2025-05-19 20:41:22,556 - INFO - Fetching data for batch 1: 14 symbols\n2025-05-19 20:41:26,063 - INFO - Streamed 14 records to KDB+ table 'stocks'\n2025-05-19 20:41:26,063 - INFO - Completed iteration 1. Next run at 20:41:52\n2025-05-19 20:41:52,642 - INFO - Fetching data for batch 1: 14 symbols\n2025-05-19 20:41:55,327 - INFO - Streamed 14 records to KDB+ table 'stocks'\n2025-05-19 20:41:55,327 - INFO - Completed iteration 2. Next run at 20:42:22\n2025-05-19 20:42:22,664 - INFO - Fetching data for batch 1: 14 symbols\n2025-05-19 20:42:25,360 - INFO - Streamed 14 records to KDB+ table 'stocks'\n2025-05-19 20:42:25,360 - INFO - Completed iteration 3. Next run at 20:42:52\n"})}),"\n",(0,i.jsx)(t.p,{children:"Let\u2019s take a closer look at the incoming data."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"q)stocks\ntime                          sym   feedHandlerTime               open    high     low     close    volume    bid    ask    bidSize askSize\n-------------------------------------------------------------------------------------------------------------------------------------------\n2025.05.19D20:41:26.062916000 AMZN  2025.05.19D20:41:22.556000000 201.645 206.62   201.26  205.47   23999471  195.53 205.94 1       1\n2025.05.19D20:41:26.062916000 GOOGL 2025.05.19D20:41:22.556000000 164.51  166.07   164.22  165.78   24114304  165.75 172    1       2\n2025.05.19D20:41:26.062916000 HD    2025.05.19D20:41:22.556000000 374.19  381.145  374.23  379.49   2873584   379.27 379.26 13      8\n2025.05.19D20:41:26.062916000 JNJ   2025.05.19D20:41:22.556000000 151.89  152.41   151.05  152.41   4847505   152.13 152.15 10      11\n2025.05.19D20:41:26.062916000 JPM   2025.05.19D20:41:22.556000000 265.55  268.31   261.93  264.965  9446982   265.11 265.17 8       9\n2025.05.19D20:41:26.062916000 MA    2025.05.19D20:41:22.556000000 581.015 588.45   580.48  585.265  1134011   585.04 585.29 11      8\n2025.05.19D20:41:26.062916000 META  2025.05.19D20:41:22.556000000 628.25  643      627.9   639.038  7486566   609.58 658.53 1       4\n2025.05.19D20:41:26.062916000 MSFT  2025.05.19D20:41:22.556000000 450.875 459.585  450.875 457.49   13771984  455.03 457.76 4       2\n2025.05.19D20:41:26.062916000 NVDA  2025.05.19D20:41:22.556000000 132.41  135.87   132.41  135.216  164733322 134.99 135.45 1       1\n2025.05.19D20:41:26.062916000 PG    2025.05.19D20:41:22.556000000 163.47  165.15   163.41  164.54   5727733   164.37 164.43 9       8\n2025.05.19D20:41:26.062916000 TSLA  2025.05.19D20:41:22.556000000 336.34  343      333.38  342.3106 77338471  339    348    2       1\n2025.05.19D20:41:26.062916000 UNH   2025.05.19D20:41:22.556000000 304.775 316.21   297.245 314.7999 55893400  312.55 312.43 11      14\n2025.05.19D20:41:26.062916000 V     2025.05.19D20:41:22.556000000 363.02  369.1499 362.321 367.73   3239193   367.38 367.43 8       10\n2025.05.19D20:41:26.062916000 WMT   2025.05.19D20:41:22.556000000 96.65   98.26    95.8101 98.189   13795258  98.05  98.07  10      10\nq)stocks\ntime                          sym   feedHandlerTime               open    high     low     close    volume    bid    ask    bidSize askSize\n-------------------------------------------------------------------------------------------------------------------------------------------\n2025.05.19D20:41:26.062916000 AMZN  2025.05.19D20:41:22.556000000 201.645 206.62   201.26  205.47   23999471  195.53 205.94 1       1\n2025.05.19D20:41:26.062916000 GOOGL 2025.05.19D20:41:22.556000000 164.51  166.07   164.22  165.78   24114304  165.75 172    1       2\n2025.05.19D20:41:26.062916000 HD    2025.05.19D20:41:22.556000000 374.19  381.145  374.23  379.49   2873584   379.27 379.26 13      8\n2025.05.19D20:41:26.062916000 JNJ   2025.05.19D20:41:22.556000000 151.89  152.41   151.05  152.41   4847505   152.13 152.15 10      11\n2025.05.19D20:41:26.062916000 JPM   2025.05.19D20:41:22.556000000 265.55  268.31   261.93  264.965  9446982   265.11 265.17 8       9\n2025.05.19D20:41:26.062916000 MA    2025.05.19D20:41:22.556000000 581.015 588.45   580.48  585.265  1134011   585.04 585.29 11      8\n2025.05.19D20:41:26.062916000 META  2025.05.19D20:41:22.556000000 628.25  643      627.9   639.038  7486566   609.58 658.53 1       4\n2025.05.19D20:41:26.062916000 MSFT  2025.05.19D20:41:22.556000000 450.875 459.585  450.875 457.49   13771984  455.03 457.76 4       2\n2025.05.19D20:41:26.062916000 NVDA  2025.05.19D20:41:22.556000000 132.41  135.87   132.41  135.216  164733322 134.99 135.45 1       1\n2025.05.19D20:41:26.062916000 PG    2025.05.19D20:41:22.556000000 163.47  165.15   163.41  164.54   5727733   164.37 164.43 9       8\n2025.05.19D20:41:26.062916000 TSLA  2025.05.19D20:41:22.556000000 336.34  343      333.38  342.3106 77338471  339    348    2       1\n2025.05.19D20:41:26.062916000 UNH   2025.05.19D20:41:22.556000000 304.775 316.21   297.245 314.7999 55893400  312.55 312.43 11      14\n2025.05.19D20:41:26.062916000 V     2025.05.19D20:41:22.556000000 363.02  369.1499 362.321 367.73   3239193   367.38 367.43 8       10\n2025.05.19D20:41:26.062916000 WMT   2025.05.19D20:41:22.556000000 96.65   98.26    95.8101 98.189   13795258  98.05  98.07  10      10\n2025.05.19D20:41:55.327104000 AMZN  2025.05.19D20:41:52.643000000 201.645 206.62   201.26  205.52   24022841  200    205.94 2       1\n2025.05.19D20:41:55.327104000 GOOGL 2025.05.19D20:41:52.643000000 164.51  166.07   164.22  165.84   24144223  165.75 172    1       2\n2025.05.19D20:41:55.327104000 HD    2025.05.19D20:41:52.643000000 374.19  381.145  374.23  379.475  2877334   379.27 379.31 13      8\n2025.05.19D20:41:55.327104000 JNJ   2025.05.19D20:41:52.643000000 151.89  152.41   151.05  152.395  4854132   152.12 152.14 10      11\n2025.05.19D20:41:55.327104000 JPM   2025.05.19D20:41:52.643000000 265.55  268.31   261.93  264.975  9457337   265.11 265.18 8       9\n2025.05.19D20:41:55.327104000 MA    2025.05.19D20:41:52.643000000 581.015 588.45   580.48  585.35   1137405   585.04 585.44 11      8\n2025.05.19D20:41:55.327104000 META  2025.05.19D20:41:52.643000000 628.25  643      627.9   639.35   7497210   609.58 658.53 1       4\n2025.05.19D20:41:55.327104000 MSFT  2025.05.19D20:41:52.643000000 450.875 459.585  450.875 457.5375 13786633  455.03 457.76 4       2\n2025.05.19D20:41:55.327104000 NVDA  2025.05.19D20:41:52.643000000 132.41  135.87   132.41  135.265  164894932 135.05 135.51 1       1\n2025.05.19D20:41:55.327104000 PG    2025.05.19D20:41:52.643000000 163.47  165.15   163.41  164.545  5732887   164.37 164.43 9       8\n2025.05.19D20:41:55.327104000 TSLA  2025.05.19D20:41:52.643000000 336.34  343      333.38  342.4911 77449325  339    342.53 2       1\n2025.05.19D20:41:55.327104000 UNH   2025.05.19D20:41:52.643000000 304.775 316.21   297.245 314.575  55935141  312.8  312.92 11      14\n2025.05.19D20:41:55.327104000 V     2025.05.19D20:41:52.643000000 363.02  369.1499 362.321 367.72   3245083   367.38 367.54 8       10\n2025.05.19D20:41:55.327104000 WMT   2025.05.19D20:41:52.643000000 96.65   98.26    95.8101 98.1883  13833048  98.07  98.07  10      10\nq)count stocks\n28\nq)stocks\ntime                          sym   feedHandlerTime               open    high     low     close    volume    bid    ask    bidSize askSize\n-------------------------------------------------------------------------------------------------------------------------------------------\n2025.05.19D20:41:26.062916000 AMZN  2025.05.19D20:41:22.556000000 201.645 206.62   201.26  205.47   23999471  195.53 205.94 1       1\n2025.05.19D20:41:26.062916000 GOOGL 2025.05.19D20:41:22.556000000 164.51  166.07   164.22  165.78   24114304  165.75 172    1       2\n2025.05.19D20:41:26.062916000 HD    2025.05.19D20:41:22.556000000 374.19  381.145  374.23  379.49   2873584   379.27 379.26 13      8\n2025.05.19D20:41:26.062916000 JNJ   2025.05.19D20:41:22.556000000 151.89  152.41   151.05  152.41   4847505   152.13 152.15 10      11\n2025.05.19D20:41:26.062916000 JPM   2025.05.19D20:41:22.556000000 265.55  268.31   261.93  264.965  9446982   265.11 265.17 8       9\n2025.05.19D20:41:26.062916000 MA    2025.05.19D20:41:22.556000000 581.015 588.45   580.48  585.265  1134011   585.04 585.29 11      8\n2025.05.19D20:41:26.062916000 META  2025.05.19D20:41:22.556000000 628.25  643      627.9   639.038  7486566   609.58 658.53 1       4\n2025.05.19D20:41:26.062916000 MSFT  2025.05.19D20:41:22.556000000 450.875 459.585  450.875 457.49   13771984  455.03 457.76 4       2\n2025.05.19D20:41:26.062916000 NVDA  2025.05.19D20:41:22.556000000 132.41  135.87   132.41  135.216  164733322 134.99 135.45 1       1\n2025.05.19D20:41:26.062916000 PG    2025.05.19D20:41:22.556000000 163.47  165.15   163.41  164.54   5727733   164.37 164.43 9       8\n2025.05.19D20:41:26.062916000 TSLA  2025.05.19D20:41:22.556000000 336.34  343      333.38  342.3106 77338471  339    348    2       1\n2025.05.19D20:41:26.062916000 UNH   2025.05.19D20:41:22.556000000 304.775 316.21   297.245 314.7999 55893400  312.55 312.43 11      14\n2025.05.19D20:41:26.062916000 V     2025.05.19D20:41:22.556000000 363.02  369.1499 362.321 367.73   3239193   367.38 367.43 8       10\n2025.05.19D20:41:26.062916000 WMT   2025.05.19D20:41:22.556000000 96.65   98.26    95.8101 98.189   13795258  98.05  98.07  10      10\n2025.05.19D20:41:55.327104000 AMZN  2025.05.19D20:41:52.643000000 201.645 206.62   201.26  205.52   24022841  200    205.94 2       1\n2025.05.19D20:41:55.327104000 GOOGL 2025.05.19D20:41:52.643000000 164.51  166.07   164.22  165.84   24144223  165.75 172    1       2\n2025.05.19D20:41:55.327104000 HD    2025.05.19D20:41:52.643000000 374.19  381.145  374.23  379.475  2877334   379.27 379.31 13      8\n2025.05.19D20:41:55.327104000 JNJ   2025.05.19D20:41:52.643000000 151.89  152.41   151.05  152.395  4854132   152.12 152.14 10      11\n2025.05.19D20:41:55.327104000 JPM   2025.05.19D20:41:52.643000000 265.55  268.31   261.93  264.975  9457337   265.11 265.18 8       9\n2025.05.19D20:41:55.327104000 MA    2025.05.19D20:41:52.643000000 581.015 588.45   580.48  585.35   1137405   585.04 585.44 11      8\n2025.05.19D20:41:55.327104000 META  2025.05.19D20:41:52.643000000 628.25  643      627.9   639.35   7497210   609.58 658.53 1       4\n2025.05.19D20:41:55.327104000 MSFT  2025.05.19D20:41:52.643000000 450.875 459.585  450.875 457.5375 13786633  455.03 457.76 4       2\n2025.05.19D20:41:55.327104000 NVDA  2025.05.19D20:41:52.643000000 132.41  135.87   132.41  135.265  164894932 135.05 135.51 1       1\n2025.05.19D20:41:55.327104000 PG    2025.05.19D20:41:52.643000000 163.47  165.15   163.41  164.545  5732887   164.37 164.43 9       8\n2025.05.19D20:41:55.327104000 TSLA  2025.05.19D20:41:52.643000000 336.34  343      333.38  342.4911 77449325  339    342.53 2       1\n2025.05.19D20:41:55.327104000 UNH   2025.05.19D20:41:52.643000000 304.775 316.21   297.245 314.575  55935141  312.8  312.92 11      14\n2025.05.19D20:41:55.327104000 V     2025.05.19D20:41:52.643000000 363.02  369.1499 362.321 367.72   3245083   367.38 367.54 8       10\n2025.05.19D20:41:55.327104000 WMT   2025.05.19D20:41:52.643000000 96.65   98.26    95.8101 98.1883  13833048  98.07  98.07  10      10\n2025.05.19D20:42:25.360198000 AMZN  2025.05.19D20:42:22.665000000 201.645 206.62   201.26  205.51   24037280  195.53 205.94 1       1\n2025.05.19D20:42:25.360198000 GOOGL 2025.05.19D20:42:22.665000000 164.51  166.07   164.22  165.815  24171372  165.75 172    1       2\n2025.05.19D20:42:25.360198000 HD    2025.05.19D20:42:22.665000000 374.19  381.145  374.23  379.43   2882141   379.12 379.31 13      8\n2025.05.19D20:42:25.360198000 JNJ   2025.05.19D20:42:22.665000000 151.89  152.41   151.05  152.39   4856696   152.12 152.14 10      11\n2025.05.19D20:42:25.360198000 JPM   2025.05.19D20:42:22.665000000 265.55  268.31   261.93  264.8824 9464132   265.09 265.11 8       9\n2025.05.19D20:42:25.360198000 MA    2025.05.19D20:42:22.665000000 581.015 588.45   580.48  585.26   1138452   585.04 585.44 11      8\n2025.05.19D20:42:25.360198000 META  2025.05.19D20:42:22.665000000 628.25  643      627.9   639.095  7503508   609.58 658.53 1       4\n2025.05.19D20:42:25.360198000 MSFT  2025.05.19D20:42:22.665000000 450.875 459.585  450.875 457.46   13795208  455.03 457.76 4       2\n2025.05.19D20:42:25.360198000 NVDA  2025.05.19D20:42:22.665000000 132.41  135.87   132.41  135.245  164987096 135.03 135.49 1       1\n2025.05.19D20:42:25.360198000 PG    2025.05.19D20:42:22.665000000 163.47  165.15   163.41  164.565  5738934   164.38 164.41 9       8\n2025.05.19D20:42:25.360198000 TSLA  2025.05.19D20:42:22.665000000 336.34  343      333.38  342.26   77520926  339    348    2       1\n2025.05.19D20:42:25.360198000 UNH   2025.05.19D20:42:22.665000000 304.775 316.21   297.245 314.57   56023879  312.8  312.92 11      14\n2025.05.19D20:42:25.360198000 V     2025.05.19D20:42:22.665000000 363.02  369.1499 362.321 367.71   3247511   367.38 367.54 8       10\n2025.05.19D20:42:25.360198000 WMT   2025.05.19D20:42:22.665000000 96.65   98.26    95.8101 98.195   13851133  97.99  98.07  10      10\nq)count stocks\n42\nq)meta stocks\nc              | t f a\n---------------| -----\ntime           | p   s\nsym            | s   g\nfeedHandlerTime| p\nopen           | f\nhigh           | f\nlow            | f\nclose          | f\nvolume         | i\nbid            | f\nask            | f\nbidSize        | i\naskSize        | i\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Let it run as long as you'd like, and when you're ready to shut it down, simply press ",(0,i.jsx)(t.code,{children:"CTRL+C"})," to exit the Python script."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"2025-05-19 20:42:25,360 - INFO - Completed iteration 3. Next run at 20:42:52\n^C2025-05-19 20:42:48,192 - INFO - Received keyboard interrupt. Shutting down...\n2025-05-19 20:42:48,192 - INFO - Closed KDB+ connection\n"})}),"\n",(0,i.jsx)(t.p,{children:"I hope you found this tutorial useful and got a glimpse of the power and flexibility of KDB/Q, especially how straightforward it can be to build a real-time streaming application. In the next tutorial, we\u2019ll learn how to build a historical stock price database for research purposes. Stay tuned!"}),"\n",(0,i.jsx)(t.h2,{id:"resources",children:"Resources"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["yfinance library: ",(0,i.jsx)(t.a,{href:"https://github.com/ranaroussi/yfinance",children:"Githup repo"})]}),"\n",(0,i.jsxs)(t.li,{children:["qpython library: ",(0,i.jsx)(t.a,{href:"https://github.com/exxeleron/qPython/tree/master",children:"Github repo"})]}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://qpython.readthedocs.io/en/latest/#",children:"qpython Documentation"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/architecture/plain",children:"The Plain Vanilla Tick Setup"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/tutorials/tick",children:"KDB Tick Explained: A Walkthrough"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/concepts/attributes",children:"Attributes"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/concepts/dictionariesTables",children:"Dictionaries and Tables"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://www.defconq.tech/docs/concepts/ipc",children:"Fundamentals of Interprocess Communication (IPC)"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},3409:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/RealTimeFeed-249b136d5af7dfd2466b60a2e5b5b695.png"},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var i=n(96540);const a={},s=i.createContext(a);function r(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);