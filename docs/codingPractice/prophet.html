<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-codingPractice/prophet" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">If the Mountain Won’t Come to You... | DefconQ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://DefconQ.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://DefconQ.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://DefconQ.github.io/docs/codingPractice/prophet"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="If the Mountain Won’t Come to You... | DefconQ"><meta data-rh="true" name="description" content="You’ve probably heard the saying, “If the mountain doesn’t come to the prophet, the prophet must go to the mountain.”. And no, I haven’t suddenly become a philosopher, so bear with me, this has everything to do with KDB/Q development."><meta data-rh="true" property="og:description" content="You’ve probably heard the saying, “If the mountain doesn’t come to the prophet, the prophet must go to the mountain.”. And no, I haven’t suddenly become a philosopher, so bear with me, this has everything to do with KDB/Q development."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://DefconQ.github.io/docs/codingPractice/prophet"><link data-rh="true" rel="alternate" href="https://DefconQ.github.io/docs/codingPractice/prophet" hreflang="en"><link data-rh="true" rel="alternate" href="https://DefconQ.github.io/docs/codingPractice/prophet" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://R6JV2N50EX-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DefconQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DefconQ Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E9ED09HNE3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E9ED09HNE3",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="DefconQ" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.5860f28a.css">
<script src="/assets/js/runtime~main.69dc71ef.js" defer="defer"></script>
<script src="/assets/js/main.238aeed9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#74e8a3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">Stay up to date with the latest blogs posts - subscribe to my free Substack newsletter now <a href="https://defconq.substack.com">Free Substack Newsletter</a> or follow me on <a href="https://medium.com/@defconq">Medium</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="DefconQ Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="150" width="50"><img src="/img/logoLight.svg" alt="DefconQ Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="150" width="50"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Learn</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/about/about">About</a><a class="navbar__item navbar__link" href="/testimonials/testimonials">Testimonials</a><a class="navbar__item navbar__link" href="/happyHour/happyHour">Happy Hour</a><a class="navbar__item navbar__link" href="/cv/cv">CV</a><a href="https://defconq.substack.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Substack Newsletter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://medium.com/@defconq" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://defconq.myspreadshop.co.uk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Swag<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/DefconQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/kdbq-study-roadmap">KDB/Q Study Roadmap</a><button aria-label="Expand sidebar category &#x27;KDB/Q Study Roadmap&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/kdbq-language">KDB/Q Language</a><button aria-label="Expand sidebar category &#x27;KDB/Q Language&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/kdbq-architecture">KDB/Q Architecture</a><button aria-label="Expand sidebar category &#x27;KDB/Q Architecture&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/important-concepts">Important Concepts</a><button aria-label="Expand sidebar category &#x27;Important Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/design-patterns-for-kdbq-systems">Design Patterns for KDB/Q Systems</a><button aria-label="Collapse sidebar category &#x27;Design Patterns for KDB/Q Systems&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/codingPractice/prophet">If the Mountain Won’t Come to You...</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/codingPractice/codeOrganisation">Code Organistation - Your own KDB/Q Library</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorials">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/productivity-tools">Productivity Tools</a><button aria-label="Expand sidebar category &#x27;Productivity Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/design-patterns-for-kdbq-systems"><span itemprop="name">Design Patterns for KDB/Q Systems</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">If the Mountain Won’t Come to You...</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>If the Mountain Won’t Come to You...</h1>
<p>You’ve probably heard the saying, <em><strong>“If the mountain doesn’t come to the prophet, the prophet must go to the mountain.”</strong></em>. And no, I haven’t suddenly become a philosopher, so bear with me, this has everything to do with KDB/Q development.</p>
<p>System architecture often requires a bit of abstract thinking. One of the biggest challenges in big data systems is the cost of moving data, fetching massive datasets from a database just to analyze them elsewhere can create serious performance bottlenecks. Transferring raw data over networks (especially across geographies) slows everything down.</p>
<p>But here’s where KDB/Q shines. Unlike most time-series databases, it’s not just a database, it&#x27;s much more than that, it&#x27;s a full blown array programming language, purpose-built for data analysis. Instead of dragging all your data across the network to crunch numbers elsewhere, you bring your logic to <em><strong>the data</strong></em>. Run your business logic where the data lives, send back only the final result, <strong>compact, efficient, fast</strong>.</p>
<p>Just like the proverb: when the data won’t come to you, you go to the data.</p>
<p>In this short and simplified blog post, I’ll walk you through how to bring the above concept to life. We’ll keep things minimal for clarity’s sake, using a basic example, but once you grasp the core idea, you’ll see how it scales up to more complex, production-grade systems.</p>
<p><img decoding="async" loading="lazy" alt="If the Mountain won&amp;#39;t come to you" src="/assets/images/prophet-bc3f58385e66227df99db1a35126f937.png" width="1024" height="1024" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="laying-the-groundwork-simulating-the-mountain">Laying the Groundwork: Simulating the Mountain<a href="#laying-the-groundwork-simulating-the-mountain" class="hash-link" aria-label="Direct link to Laying the Groundwork: Simulating the Mountain" title="Direct link to Laying the Groundwork: Simulating the Mountain">​</a></h2>
<p>Before we can demonstrate the concept in action, we need to set the stage. We&#x27;ll simulate a process holding equity data for four symbols, Apple, Google, IBM, and Microsoft, spanning four days. We simulate a dataset of one million records. While that’s modest in the world of big data (and child&#x27;s play for KDB/Q), it’s perfect for illustrating the core idea. Once you understand the approach, scaling it to fit real-world, complex systems will be straightforward.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q)n:1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)equities:([] date:n?.z.D+til 4;sym:n?`AAPL`GOOG`MSFT`IBM;price:n?100.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)select count i by sym from equities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sym | x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----| ------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAPL| 249888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOOG| 249475</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IBM | 250141</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MSFT| 250496</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)select count i by date from equities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date      | x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------| ------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02| 250353</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03| 249858</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04| 249946</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05| 249843</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)-22!equities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16749915</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)1e-6*-22!equities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16.74991</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As shown in the code snippet above, we’ve now created an <code>equities</code> table with one million records, about 250,000 rows for each symbol and each date. Before jumping into our analytics, let’s take a look at the table’s size. Using the <a href="https://code.kx.com/q/basics/internal/#-22x-uncompressed-length" target="_blank" rel="noopener noreferrer"><code>-22!</code></a> operator, which returns the size of an object in bytes. A quick conversion reveals our table occupies 16MB. Now, let’s move on to the analytics: we’ll calculate the open, high, low, and close prices for every date-symbol combination. This is nothing complex, just a simple one-liner in KDB/Q. Timing the computation shows it completes in just 16 milliseconds, and the resulting summary table is tiny: only 756 bytes.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q)exec `open`high`low`close!(first;max;min;last)@\:price by date,sym from equities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date       sym | open     high     low          close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------| ---------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 AAPL| 52.94808 99.99837 0.001122733  70.24182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 GOOG| 8.388858 99.99769 0.001475797  37.44706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 IBM | 30.17723 99.99893 0.001599733  70.03851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 MSFT| 51.59796 99.99651 8.079223e-05 16.81099</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 AAPL| 40.66642 99.99756 0.0007903203 49.7864</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 GOOG| 17.80839 99.99987 0.0002427492 80.39763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 IBM | 23.06385 99.99921 0.001205644  49.26256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 MSFT| 49.31835 99.99372 0.0007542549 37.21083</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 AAPL| 53.47096 99.99956 0.000825664  34.08364</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 GOOG| 25.60658 99.99473 0.001111603  32.36165</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 IBM | 97.85    99.99736 0.00116278   39.62569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 MSFT| 78.5033  99.99915 0.002760184  95.05164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 AAPL| 51.70911 99.99866 0.001044618  77.00343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 GOOG| 47.07883 99.99848 0.007454539  81.31288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 IBM | 15.08133 99.99977 0.003722939  91.16196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 MSFT| 39.27524 99.99911 0.0002150191 6.901068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)\ts exec `open`high`low`close!(first;max;min;last)@\:price by date,sym from equities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16 41944416</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)-22!exec `open`high`low`close!(first;max;min;last)@\:price by date,sym from equities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">756</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-old-school-data-detour-dragging-data-the-long-way-around">The Old-School Data Detour: Dragging Data the Long Way Around<a href="#the-old-school-data-detour-dragging-data-the-long-way-around" class="hash-link" aria-label="Direct link to The Old-School Data Detour: Dragging Data the Long Way Around" title="Direct link to The Old-School Data Detour: Dragging Data the Long Way Around">​</a></h2>
<p>Next, let’s mimic the typical approach most mainstream developers follow, hink Python or Java. The standard workflow involves connecting to a database, pulling over the raw data, and then performing analytics locally within the application. It’s a slow and resource-heavy method, especially unsuited for latency-sensitive environments. To simulate this in KDB/Q, we start by assigning port <code>7777</code> to the process that holds our equities data, then connect to it from a separate client process, just as an external app would.</p>
<p>We start by connecting to the data process using <a href="https://code.kx.com/q/ref/hopen/" target="_blank" rel="noopener noreferrer"><code>hopen</code></a>, which sets up a communication channel between the client and server processes. Then, we use a lambda, an anonymous function, to fetch the entire <code>equities</code> table and perform the analytics locally on the client side. For clarity, we also output the size of the data both before and after the analytics step. As expected, the full dataset is transferred across the network, 16MB of it. While that may not seem like much in this example, in real-world production systems, this kind of data movement can become a major performance bottleneck. When we measure the runtime, this client-side approach takes 56 milliseconds, about 3.5 times longer than executing the same calculation directly on the server.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q)h:hopen 7777</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q){data:h &quot;select from equities&quot;;show -22!data;show result:exec `open`high`low`close!(first;max;min;last)@\:price by date,sym from data;show -22!result}[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16749915</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date       sym | open     high     low          close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------| ---------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 AAPL| 52.94808 99.99837 0.001122733  70.24182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 GOOG| 8.388858 99.99769 0.001475797  37.44706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 IBM | 30.17723 99.99893 0.001599733  70.03851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 MSFT| 51.59796 99.99651 8.079223e-05 16.81099</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 AAPL| 40.66642 99.99756 0.0007903203 49.7864</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 GOOG| 17.80839 99.99987 0.0002427492 80.39763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 IBM | 23.06385 99.99921 0.001205644  49.26256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 MSFT| 49.31835 99.99372 0.0007542549 37.21083</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 AAPL| 53.47096 99.99956 0.000825664  34.08364</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 GOOG| 25.60658 99.99473 0.001111603  32.36165</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 IBM | 97.85    99.99736 0.00116278   39.62569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 MSFT| 78.5033  99.99915 0.002760184  95.05164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 AAPL| 51.70911 99.99866 0.001044618  77.00343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 GOOG| 47.07883 99.99848 0.007454539  81.31288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 IBM | 15.08133 99.99977 0.003722939  91.16196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 MSFT| 39.27524 99.99911 0.0002150191 6.901068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">756</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)\ts {data:h &quot;select from equities&quot;;show -22!data;show result:exec `open`high`low`close!(first;max;min;last)@\:price by date,sym from data;show -22!result}[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16749915</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date       sym | open     high     low          close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------| ---------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 AAPL| 52.94808 99.99837 0.001122733  70.24182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 GOOG| 8.388858 99.99769 0.001475797  37.44706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 IBM | 30.17723 99.99893 0.001599733  70.03851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 MSFT| 51.59796 99.99651 8.079223e-05 16.81099</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 AAPL| 40.66642 99.99756 0.0007903203 49.7864</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 GOOG| 17.80839 99.99987 0.0002427492 80.39763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 IBM | 23.06385 99.99921 0.001205644  49.26256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 MSFT| 49.31835 99.99372 0.0007542549 37.21083</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 AAPL| 53.47096 99.99956 0.000825664  34.08364</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 GOOG| 25.60658 99.99473 0.001111603  32.36165</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 IBM | 97.85    99.99736 0.00116278   39.62569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 MSFT| 78.5033  99.99915 0.002760184  95.05164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 AAPL| 51.70911 99.99866 0.001044618  77.00343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 GOOG| 47.07883 99.99848 0.007454539  81.31288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 IBM | 15.08133 99.99977 0.003722939  91.16196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 MSFT| 39.27524 99.99911 0.0002150191 6.901068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">756</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">56 62917344</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="no-more-data-dragging-the-kdbq-way-to-bring-logic-to-data">No More Data Dragging: The KDB/Q Way to Bring Logic to Data<a href="#no-more-data-dragging-the-kdbq-way-to-bring-logic-to-data" class="hash-link" aria-label="Direct link to No More Data Dragging: The KDB/Q Way to Bring Logic to Data" title="Direct link to No More Data Dragging: The KDB/Q Way to Bring Logic to Data">​</a></h2>
<p>Now that we’ve explored the conventional, and inefficient, method of moving raw data across the network, let’s turn to a more elegant solution: the KDB/Q way. Instead of pulling the full dataset to the client, we define a <code>getData</code> function directly on the server. This function performs the open, high, low, and close (OHLC) analytics right where the data lives, returning only the summarized result. This approach drastically reduces network traffic and improves performance. Let’s walk through how it works.</p>
<p>First, we define the function <code>getData</code> on the server and run it locally. This verifies that it returns the desired result.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q)getData:{exec `open`high`low`close!(first;max;min;last)@\:price by date,sym from equities}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)getData[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date       sym | open     high     low          close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------| ---------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 AAPL| 52.94808 99.99837 0.001122733  70.24182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 GOOG| 8.388858 99.99769 0.001475797  37.44706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 IBM | 30.17723 99.99893 0.001599733  70.03851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 MSFT| 51.59796 99.99651 8.079223e-05 16.81099</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 AAPL| 40.66642 99.99756 0.0007903203 49.7864</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 GOOG| 17.80839 99.99987 0.0002427492 80.39763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 IBM | 23.06385 99.99921 0.001205644  49.26256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 MSFT| 49.31835 99.99372 0.0007542549 37.21083</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 AAPL| 53.47096 99.99956 0.000825664  34.08364</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 GOOG| 25.60658 99.99473 0.001111603  32.36165</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 IBM | 97.85    99.99736 0.00116278   39.62569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 MSFT| 78.5033  99.99915 0.002760184  95.05164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 AAPL| 51.70911 99.99866 0.001044618  77.00343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 GOOG| 47.07883 99.99848 0.007454539  81.31288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 IBM | 15.08133 99.99977 0.003722939  91.16196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 MSFT| 39.27524 99.99911 0.0002150191 6.901068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)-22!getData[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">756</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)\ts getData[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">15 41943696</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next, we call this function remotely from our client using IPC, allowing the server to execute the computation and return only the summarized result.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q)show result:h(`getData;`)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date       sym | open     high     low          close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------| ---------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 AAPL| 52.94808 99.99837 0.001122733  70.24182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 GOOG| 8.388858 99.99769 0.001475797  37.44706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 IBM | 30.17723 99.99893 0.001599733  70.03851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 MSFT| 51.59796 99.99651 8.079223e-05 16.81099</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 AAPL| 40.66642 99.99756 0.0007903203 49.7864</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 GOOG| 17.80839 99.99987 0.0002427492 80.39763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 IBM | 23.06385 99.99921 0.001205644  49.26256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 MSFT| 49.31835 99.99372 0.0007542549 37.21083</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 AAPL| 53.47096 99.99956 0.000825664  34.08364</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 GOOG| 25.60658 99.99473 0.001111603  32.36165</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 IBM | 97.85    99.99736 0.00116278   39.62569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 MSFT| 78.5033  99.99915 0.002760184  95.05164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 AAPL| 51.70911 99.99866 0.001044618  77.00343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 GOOG| 47.07883 99.99848 0.007454539  81.31288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 IBM | 15.08133 99.99977 0.003722939  91.16196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 MSFT| 39.27524 99.99911 0.0002150191 6.901068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)-22!result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">756</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)\ts show result:h(`getData;`)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date       sym | open     high     low          close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------| ---------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 AAPL| 52.94808 99.99837 0.001122733  70.24182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 GOOG| 8.388858 99.99769 0.001475797  37.44706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 IBM | 30.17723 99.99893 0.001599733  70.03851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 MSFT| 51.59796 99.99651 8.079223e-05 16.81099</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 AAPL| 40.66642 99.99756 0.0007903203 49.7864</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 GOOG| 17.80839 99.99987 0.0002427492 80.39763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 IBM | 23.06385 99.99921 0.001205644  49.26256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 MSFT| 49.31835 99.99372 0.0007542549 37.21083</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 AAPL| 53.47096 99.99956 0.000825664  34.08364</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 GOOG| 25.60658 99.99473 0.001111603  32.36165</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 IBM | 97.85    99.99736 0.00116278   39.62569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 MSFT| 78.5033  99.99915 0.002760184  95.05164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 AAPL| 51.70911 99.99866 0.001044618  77.00343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 GOOG| 47.07883 99.99848 0.007454539  81.31288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 IBM | 15.08133 99.99977 0.003722939  91.16196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 MSFT| 39.27524 99.99911 0.0002150191 6.901068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">17 4196928</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As we can see, this approach is not only significantly faster than the traditional method, but it also drastically reduces the amount of data transferred over the network. In fact, the performance closely matches that of running the query directly on the server, which makes sense, since that&#x27;s exactly what&#x27;s happening. Only the summarized result is returned, using just 756 bytes, exactly as if the query had been executed locally.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="from-static-to-dynamic-unlocking-full-flexibility">From Static to Dynamic: Unlocking Full Flexibility<a href="#from-static-to-dynamic-unlocking-full-flexibility" class="hash-link" aria-label="Direct link to From Static to Dynamic: Unlocking Full Flexibility" title="Direct link to From Static to Dynamic: Unlocking Full Flexibility">​</a></h2>
<p>You might be thinking, wait a second, doesn’t this become limiting if we have to hardcode our analytics function on the server? What happens when we want to modify the logic, query a different table, or tweak parameters? Do we need to update the server code and redeploy every time? That would be a nightmare for flexibility and release cycles. Fortunately, that’s not the case. One of the powerful aspects of KDB/Q (and functional programming in general) is the ability to define lambdas, anonymous functions, that can be sent over IPC at runtime. No need to predefine anything on the server. Let’s see how that works in practice.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q)show result:h({exec `open`high`low`close!(first;max;min;last)@\:price by date,sym from equities};`)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date       sym | open     high     low          close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------| ---------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 AAPL| 52.94808 99.99837 0.001122733  70.24182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 GOOG| 8.388858 99.99769 0.001475797  37.44706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 IBM | 30.17723 99.99893 0.001599733  70.03851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 MSFT| 51.59796 99.99651 8.079223e-05 16.81099</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 AAPL| 40.66642 99.99756 0.0007903203 49.7864</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 GOOG| 17.80839 99.99987 0.0002427492 80.39763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 IBM | 23.06385 99.99921 0.001205644  49.26256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 MSFT| 49.31835 99.99372 0.0007542549 37.21083</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 AAPL| 53.47096 99.99956 0.000825664  34.08364</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 GOOG| 25.60658 99.99473 0.001111603  32.36165</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 IBM | 97.85    99.99736 0.00116278   39.62569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 MSFT| 78.5033  99.99915 0.002760184  95.05164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 AAPL| 51.70911 99.99866 0.001044618  77.00343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 GOOG| 47.07883 99.99848 0.007454539  81.31288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 IBM | 15.08133 99.99977 0.003722939  91.16196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 MSFT| 39.27524 99.99911 0.0002150191 6.901068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)-22!result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">756</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)\ts show result:h({exec `open`high`low`close!(first;max;min;last)@\:price by date,sym from equities};`)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date       sym | open     high     low          close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------| ---------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 AAPL| 52.94808 99.99837 0.001122733  70.24182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 GOOG| 8.388858 99.99769 0.001475797  37.44706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 IBM | 30.17723 99.99893 0.001599733  70.03851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 MSFT| 51.59796 99.99651 8.079223e-05 16.81099</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 AAPL| 40.66642 99.99756 0.0007903203 49.7864</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 GOOG| 17.80839 99.99987 0.0002427492 80.39763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 IBM | 23.06385 99.99921 0.001205644  49.26256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 MSFT| 49.31835 99.99372 0.0007542549 37.21083</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 AAPL| 53.47096 99.99956 0.000825664  34.08364</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 GOOG| 25.60658 99.99473 0.001111603  32.36165</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 IBM | 97.85    99.99736 0.00116278   39.62569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 MSFT| 78.5033  99.99915 0.002760184  95.05164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 AAPL| 51.70911 99.99866 0.001044618  77.00343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 GOOG| 47.07883 99.99848 0.007454539  81.31288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 IBM | 15.08133 99.99977 0.003722939  91.16196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 MSFT| 39.27524 99.99911 0.0002150191 6.901068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14 4198016</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can take it a step further by parameterising our lambda, passing in the table name we want to analyse. This approach doesn’t just give you the performance boost of processing data where it lives; it also offers maximum flexibility in how you design your system.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q)\ts show result:h({[x] exec `open`high`low`close!(first;max;min;last)@\:price by date,sym from x};`equities)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date       sym | open     high     low          close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------| ---------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 AAPL| 52.94808 99.99837 0.001122733  70.24182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 GOOG| 8.388858 99.99769 0.001475797  37.44706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 IBM | 30.17723 99.99893 0.001599733  70.03851</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.02 MSFT| 51.59796 99.99651 8.079223e-05 16.81099</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 AAPL| 40.66642 99.99756 0.0007903203 49.7864</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 GOOG| 17.80839 99.99987 0.0002427492 80.39763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 IBM | 23.06385 99.99921 0.001205644  49.26256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.03 MSFT| 49.31835 99.99372 0.0007542549 37.21083</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 AAPL| 53.47096 99.99956 0.000825664  34.08364</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 GOOG| 25.60658 99.99473 0.001111603  32.36165</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 IBM | 97.85    99.99736 0.00116278   39.62569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.04 MSFT| 78.5033  99.99915 0.002760184  95.05164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 AAPL| 51.70911 99.99866 0.001044618  77.00343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 GOOG| 47.07883 99.99848 0.007454539  81.31288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 IBM | 15.08133 99.99977 0.003722939  91.16196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025.08.05 MSFT| 39.27524 99.99911 0.0002150191 6.901068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14 4198048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And with that, we wrap up this simplified tutorial. You&#x27;re now equipped to apply this pattern to real-world, production-grade architectures. Feel free to reach out if you have any questions or want to dive deeper.</p>
<p><strong>Until then, happy coding!</strong></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/design-patterns-for-kdbq-systems"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Design Patterns for KDB/Q Systems</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/codingPractice/codeOrganisation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Code Organistation - Your own KDB/Q Library</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#laying-the-groundwork-simulating-the-mountain" class="table-of-contents__link toc-highlight">Laying the Groundwork: Simulating the Mountain</a></li><li><a href="#the-old-school-data-detour-dragging-data-the-long-way-around" class="table-of-contents__link toc-highlight">The Old-School Data Detour: Dragging Data the Long Way Around</a></li><li><a href="#no-more-data-dragging-the-kdbq-way-to-bring-logic-to-data" class="table-of-contents__link toc-highlight">No More Data Dragging: The KDB/Q Way to Bring Logic to Data</a></li><li><a href="#from-static-to-dynamic-unlocking-full-flexibility" class="table-of-contents__link toc-highlight">From Static to Dynamic: Unlocking Full Flexibility</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Learn</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/company/defconq/" target="_blank" rel="noopener noreferrer" class="footer__link-item">DefconQ Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/alexanderunterrainer/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Alexander Unterrainer Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://defconq.myspreadshop.co.uk" target="_blank" rel="noopener noreferrer" class="footer__link-item">DefconQ Swag<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://www.youtube.com/@DefconQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube Channel<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://defconq.substack.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Substack Newsletter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://medium.com/@defconq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/DefconQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 DefconQ Ltd. This website is maintained by Alexander Unterrainer. Disclaimer: All content shared on this website reflect solely his personal thoughts and opinions, and is not representative of any past, current, or future employers or affiliations.</div></div></div></footer></div>
</body>
</html>