<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">Code Organistation - Your own KDB/Q Library | DefconQ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://DefconQ.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://DefconQ.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://DefconQ.github.io/blog/Code Organistation - Your own KDB/Q library"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Code Organistation - Your own KDB/Q Library | DefconQ"><meta data-rh="true" name="description" content="When I first started working as a software developer in an investment bank, I was initially placed in a C# team. After completing all the onboarding, installing Microsoft Visual Studio and gaining access to my team&#x27;s codebase, I was finally able to have a look at the project I was going to work on. Little did I know, what nightmare I was about to face. Upon opening the project, I discovered that the average length of each class exceeded 15 thousand lines. Yes, you read that correctly; it&#x27;s not a typo, but the shocking reality I was faced with. Navigating the code base was hard enough, but making a change without breaking anything seemed to be impossible. Luckily, I eventually transitioned to a team that embraced the concept of code organization."><meta data-rh="true" property="og:description" content="When I first started working as a software developer in an investment bank, I was initially placed in a C# team. After completing all the onboarding, installing Microsoft Visual Studio and gaining access to my team&#x27;s codebase, I was finally able to have a look at the project I was going to work on. Little did I know, what nightmare I was about to face. Upon opening the project, I discovered that the average length of each class exceeded 15 thousand lines. Yes, you read that correctly; it&#x27;s not a typo, but the shocking reality I was faced with. Navigating the code base was hard enough, but making a change without breaking anything seemed to be impossible. Luckily, I eventually transitioned to a team that embraced the concept of code organization."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-05-15T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/AUnterrainer"><meta data-rh="true" property="article:tag" content="kdb/q,good practice,software development,programming,code organisation,libraries"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://DefconQ.github.io/blog/Code Organistation - Your own KDB/Q library"><link data-rh="true" rel="alternate" href="https://DefconQ.github.io/blog/Code Organistation - Your own KDB/Q library" hreflang="en"><link data-rh="true" rel="alternate" href="https://DefconQ.github.io/blog/Code Organistation - Your own KDB/Q library" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://R6JV2N50EX-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://DefconQ.github.io/blog/Code Organistation - Your own KDB/Q library","mainEntityOfPage":"https://DefconQ.github.io/blog/Code Organistation - Your own KDB/Q library","url":"https://DefconQ.github.io/blog/Code Organistation - Your own KDB/Q library","headline":"Code Organistation - Your own KDB/Q Library","name":"Code Organistation - Your own KDB/Q Library","description":"When I first started working as a software developer in an investment bank, I was initially placed in a C# team. After completing all the onboarding, installing Microsoft Visual Studio and gaining access to my team's codebase, I was finally able to have a look at the project I was going to work on. Little did I know, what nightmare I was about to face. Upon opening the project, I discovered that the average length of each class exceeded 15 thousand lines. Yes, you read that correctly; it's not a typo, but the shocking reality I was faced with. Navigating the code base was hard enough, but making a change without breaking anything seemed to be impossible. Luckily, I eventually transitioned to a team that embraced the concept of code organization.","datePublished":"2024-05-15T00:00:00.000Z","author":{"@type":"Person","name":"Alexander Unterrainer","description":"DefconQ, KDB/Q Developer, Consultant","url":"https://github.com/AUnterrainer","image":"/img/alex.jpeg"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://DefconQ.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DefconQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DefconQ Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E9ED09HNE3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E9ED09HNE3",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="DefconQ" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.5860f28a.css">
<script src="/assets/js/runtime~main.33bdd682.js" defer="defer"></script>
<script src="/assets/js/main.b17310f6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#74e8a3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">Stay up to date with the latest blogs posts - subscribe to my free Substack newsletter now <a href="https://defconq.substack.com">Free Substack Newsletter</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="DefconQ Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="150" width="50"><img src="/img/logoLight.svg" alt="DefconQ Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="150" width="50"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/intro">Learn</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/about/about">About</a><a class="navbar__item navbar__link" href="/testimonials/testimonials">Testimonials</a><a class="navbar__item navbar__link" href="/happyHour/happyHour">Happy Hour</a><a class="navbar__item navbar__link" href="/cv/cv">CV</a><a href="https://defconq.substack.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Newsletter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://defconq.myspreadshop.co.uk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Swag<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/DefconQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/The Array Cast - Where Code Meets Curiosity">The Array Cast - Where Code Meets Curiosity</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/DefconQ Giveaway">DefconQ Giveaway</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/KX Academic Program Relaunch">KX Academic Program Relaunch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Brews and Qs - KX and DefconQ Happy Hour!">Brews and Qs - KX and DefconQ Happy Hour!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/The Truth About Tech Jobs in Finance - Nepotism, Hedge Funds &amp; Salary Secrets!">The Truth About Tech Jobs in Finance - Nepotism, Hedge Funds &amp; Salary Secrets!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/KX Capital Markets Summit">DefconQ goes KX Capital Markets Summit - Survival of the Fastest</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/NYSE extends trading hours">New York Stock Exchange extends trading hours</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/DefconQ goes QuantStrats 2024">DefconQ goes QuantStrats 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/How to Successfully Prepare for an Interview and Land Your Dream Job">How to Successfully Prepare for an Interview and Land Your Dream Job</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Happy Birthday DefconQ">Happy Birthday DefconQ</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/KXperts - A Developer Advocacy Program by KX">KXperts - A Developer Advocacy Program by KX</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/DefconQ meets KX - Mastering KDB+ Architecture - A Panel Discussion">DefconQ meets KX - Mastering KDB+ Architecture - A Panel Discussion</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/The Magnificent Seven - Mastering KDB/Q Concepts for Data Excellence">The Magnificent Seven - Mastering KDB/Q Concepts for Data Excellence</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/DefconQ meets Fancy Quant - Alexander Unterrainer and Dimitri Bianco discuss KDB/Q">DefconQ meets Fancy Quant - Alexander Unterrainer and Dimitri Bianco discuss KDB/Q</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Advanced KDB/Q Learning Material">Advanced KDB/Q Learning Material</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/Code Organistation - Your own KDB/Q library">Code Organistation - Your own KDB/Q Library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/DefconQ at Everything, Everywhere, All with KDB/Q by Habla Computing">DefconQ at &#x27;Everything, Everywhere, All with KDB/Q&#x27; by Habla Computing</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/The importance of code review - Four eyes see more than two">The importance of code review - Four eyes see more than two</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Advent of Code -  Daily Coding Practice">Advent of Code -  Daily Coding Practice</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Where to find help">Where to find help</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/How to Read, Understand and Learn KDB/Q code">How to Read, Understand and Learn KDB/Q code</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Go-To KDB/Q Learning Resources">Go-To KDB/Q Learning Resources</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/welcome">Welcome</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Code Organistation - Your own KDB/Q Library</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-05-15T00:00:00.000Z">May 15, 2024</time> · <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/AUnterrainer" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="/img/alex.jpeg" alt="Alexander Unterrainer"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/AUnterrainer" target="_blank" rel="noopener noreferrer"><span>Alexander Unterrainer</span></a></div><small class="avatar__subtitle">DefconQ, KDB/Q Developer, Consultant</small></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>When I first started working as a software developer in an investment bank, I was initially placed in a C# team. After completing all the onboarding, installing Microsoft Visual Studio and gaining access to my team&#x27;s codebase, I was finally able to have a look at the project I was going to work on. Little did I know, what nightmare I was about to face. Upon opening the project, I discovered that the average length of each class exceeded 15 thousand lines. Yes, you read that correctly; it&#x27;s not a typo, but the shocking reality I was faced with. Navigating the code base was hard enough, but making a change without breaking anything seemed to be impossible. Luckily, I eventually transitioned to a team that embraced the concept of code organization.</p>
<p>As your codebase expands and evolves, incorporating increasingly sophisticated functionality, it naturally becomes more complex and therefore more challenging to navigate, comprehend, and maintain. Hence, it&#x27;s crucial to adopt a systematic approach to code organization. Doing so not only ensures extensibility and scalability but also simplifies development in the long run. Modularizing your code, as well as other various strategies exist for organizing code. In traditional object-oriented programming languages like Java or C#, organization typically revolves around classes, packages, or, on a broader scale, projects. However, there&#x27;s no reason why a similar concept can&#x27;t be applied in KDB/Q. In this blog post, I&#x27;ll introduce a simple yet effective method of organizing your code. Additionally, I&#x27;ll share some valuable tips and tricks gleaned from years of experience.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kdbq-code-organisation-an-example">KDB/Q Code organisation: an example<a href="#kdbq-code-organisation-an-example" class="hash-link" aria-label="Direct link to KDB/Q Code organisation: an example" title="Direct link to KDB/Q Code organisation: an example">​</a></h2>
<p>One easy way to organise your code involves splitting the code into a <strong>library file</strong> containing all Application Programming Interfaces (APIs) and an <strong>execute file</strong> containing initialization logic along with global variable definitions, loaded by a KDB/Q process upon start-up. You can then package your code into various modules or packages based on dataset, asset class, or any other classification of your preference, applying the library and execute file pattern consistently across them.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="power-packed-libraries-bundled-functionality">Power Packed Libraries: Bundled Functionality<a href="#power-packed-libraries-bundled-functionality" class="hash-link" aria-label="Direct link to Power Packed Libraries: Bundled Functionality" title="Direct link to Power Packed Libraries: Bundled Functionality">​</a></h3>
<p>To enhance the extensibility and scalability of your application, it&#x27;s recommended to make your code as modular as possible. This can be accomplished by exposing the business logic of your code through an API and consolidating functions related to specific functionalities or features into individual packages. Let&#x27;s consider the scenario where we aim to construct a library containing fundamental mathematical functions. The following code snippet demonstrates the contents of our library file:</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Below code is a very basic, simplified example for illustrative purposes</p></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// math.library.q</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// This is a library to compute basic mathematical operations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// add: 	Function to perform addition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @param: 	x - first parameter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @param: 	y - second parameter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @return: 	sum of x and y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add:{[x;y]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :x+y;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// sub: 	Function to perform subtraction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @param:	x - first parameter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @param:	y - second parameter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @return:	subtracts y from x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub:{[x;y]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :x-y;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// mult:	Function to perform multiplication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @param:	x - first parameter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @param:	y - second parameter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @result:	product of x and y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mult:{[x;y]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :x*y;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, we&#x27;ve developed our very own, simple math library featuring essential functions that can be reused as required. We can effortlessly load this library into any process to leverage its functionality without having to duplicate any code. In the following section, we&#x27;ll demonstrate how to utilize this library.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="seamless-integration-the-execute-file-solution">Seamless Integration: The Execute File Solution<a href="#seamless-integration-the-execute-file-solution" class="hash-link" aria-label="Direct link to Seamless Integration: The Execute File Solution" title="Direct link to Seamless Integration: The Execute File Solution">​</a></h3>
<p>While you can load your library into nearly any KDB/Q process allows for reusing the exposed APIs, another approach involves creating a file to be passed to a KDB/Q process during startup. Within this file, you can initialize global variables utilized within the process and establish an initialization function to be called upon the process&#x27;s start. But examples speak louder than words, so let&#x27;s check one out.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// math.exe.q</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// This is our execution file, the file we load when we start our KDB/Q process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Loading the math library we created, exposing all the functions in it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system &quot;l math.library.q&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Setting global variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num1:4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num3:8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// init:	Initialisation function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">init:{[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// Within our initialisation function we define another number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	num2:5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// We can now use the APIs defined in our libray</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	-1 &quot;Adding number &quot;,string[num1], &quot; to number &quot;, string[num2], &quot; --&gt; result: &quot;,string add[num1;num2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -1 &quot;Subtracting number &quot;,string[a], &quot; from number &quot;, string[b], &quot; --&gt; result: &quot;,string add[b:9;a:3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -1 &quot;Multiplying number &quot;,string[num2], &quot; with number &quot;, string[num3], &quot; --&gt; result: &quot;,string add[num2;num3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// At then end of our execute file we call the init function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">init[];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, we can initiate a KDB/Q process and load our execute file upon startup. This action handles the loading of our library, initializes any global variables, and then executes the init function to complete the remaining initialization tasks.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Alexander@Alexanders-MacBook-Pro:~/repos/testCode|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">⇒  qq math.exe.q</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KDB+ 4.0 2023.01.20 Copyright (C) 1993-2023 Kx Systems</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m64/ 4(24)core 8192MB Alexander alexanders-macbook-pro.local 127.0.0.1 EXPIRE 2025.02.21 XXXX@gmail.com KDB PLUS TRIAL #5018719</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adding number 4 to number 5 --&gt; result: 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Subtracting number 3 from number 9 --&gt; result: 12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Multiplying number 5 with number 8 --&gt; result: 13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Above pattern is a powerful yet simple  technique for structuring your code and enhancing its modularity. By grouping similar functionalities into a library, you can conveniently reuse them as required, thereby eliminating redundant code duplication. Additionally, the execution file provides an easy method to configure your KDB/Q process and import all necessary libraries.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="leveraging-namespaces">Leveraging Namespaces<a href="#leveraging-namespaces" class="hash-link" aria-label="Direct link to Leveraging Namespaces" title="Direct link to Leveraging Namespaces">​</a></h2>
<p>In the upcoming section, I&#x27;ll share two additional tips and tricks that I&#x27;ve found to be especially useful when organizing your code. These strategies not only contribute to cleaner code but also enhance its comprehensibility and ease of navigation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="same-yet-different">Same Yet Different<a href="#same-yet-different" class="hash-link" aria-label="Direct link to Same Yet Different" title="Direct link to Same Yet Different">​</a></h3>
<p>At times, we find ourselves repeatedly implementing similar or identical functionalities, with only minor variations, such as asset class, instrument, or data source. This practice not only complicates the code and reduces readability but it can also be very confusing for users. They may wonder which function to use, what parameters to pass, and how the result appears. In the following section, I&#x27;ll demonstrate how namespaces can simplify everyone&#x27;s workflow.</p>
<p>Let&#x27;s have a look at some code. First, we create a helper function, to verify whether a certain function exists or not. We can do so by using the <a href="https://code.kx.com/q/ref/key/" target="_blank" rel="noopener noreferrer"><code>key</code></a> operator. While the <code>key</code> operator is commonly used for retrieving the keys of a dictionary or table, it can also be used to verify whether a folder or file exists, or in our case, if a name is defined or not.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q)exists:{not ()~key x}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)exists `a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)a:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)exists `a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1b</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next, we&#x27;ll develop a set of functions that exhibit similar behavior but with slight variations. Specifically, in our scenario, he behaviour of the function differ based on the data source we want to retrieve. Additionally, we include a default function for cases where the user specifies a data source for which we haven&#x27;t implemented a function yet. In such instances, we&#x27;ll return the result using a default data source.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q).equities.bloomberg.getData:{: ([] sym:`AAPL`MSFT`GOOG; source:3#`BBG;price:3?10)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).equities.refinitive.getData:{: ([] sym:`AAPL`MSFT`GOOG; source:3#`REF;price:3?10)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).equities.default.getData:{: ([] sym:`AAPL`MSFT`GOOG; source:3#`INHOUSE;price:3?10)}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Finally, all we have to do, is to create a function that we are going to expose to our users. The user will specify the data source they desire, and the function will handle the appropriate call to the corresponding function. Should the specified data source be unavailable, we&#x27;ll return data obtained from a default source.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.equities.getData:{[datasource] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// Create the namespace for the datasource and verify if it exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// If it exists, invoke the function and return result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// If it doesn&#x27;t, invoke default function and return result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	if[exists f:` sv (`.equities;datasource;`getData);:f[]]; :.equities.default.getData[] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Below code should illustrate this behaviour</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Verify if function exists. Note: typo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)exists `.equities.bloomber.getData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Existing function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)exists `.equities.bloomberg.getData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Creating the namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)` sv `.equities`bloomberg`getData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`.equities.bloomberg.getData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Combining above</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)exists ` sv `.equities`bloomberg`getData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// individual functions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).equities.refinitive.getData[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sym  source price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAPL REF    8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MSFT REF    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOOG REF    9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).equities.bloomberg.getData[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sym  source price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAPL BBG    5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MSFT BBG    4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOOG BBG    6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// the .equities namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).equities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          | ::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bloomberg | ``getData!(::;{: ([] sym:`AAPL`MSFT`GOOG; source:3#`BBG;price:3?1..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">refinitive| ``getData!(::;{: ([] sym:`AAPL`MSFT`GOOG; source:3#`REF;price:3?1..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default   | ``getData!(::;{: ([] sym:`AAPL`MSFT`GOOG; source:3#`INHOUSE;price..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">getData   | {[datasource] if[exists f:` sv (`.equities;datasource;`getData);:..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Function exposed to and used by clients</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).equities.getData[`bloomberg]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sym  source price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAPL BBG    5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MSFT BBG    4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOOG BBG    9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).equities.getData[`refinitive]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sym  source price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAPL REF    2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MSFT REF    7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOOG REF    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Function call with data source that doesn&#x27;t exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Defaults to INHOUSE data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).equities.getData[`ICE]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sym  source  price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAPL INHOUSE 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MSFT INHOUSE 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GOOG INHOUSE 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you can see, we&#x27;ve developed a feature that exposes just one simple API to our clients, ensuring ease and simplicity in their usage. Furthermore, we&#x27;re now capable of effortlessly expanding our function&#x27;s behavior and incorporating more functionalities for new data sources, requiring minimal code refactoring.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="namespaces-revealed-your-handy-dictionary">Namespaces Revealed: Your Handy Dictionary<a href="#namespaces-revealed-your-handy-dictionary" class="hash-link" aria-label="Direct link to Namespaces Revealed: Your Handy Dictionary" title="Direct link to Namespaces Revealed: Your Handy Dictionary">​</a></h3>
<p>In KDB/Q, namespaces essentially function as dictionaries. This feature allows us to create diverse behaviors without resorting to complex and confusing <code>if-else</code> statements. You can read more about namespaces <a href="https://code.kx.com/q4m3/12_Workspace_Organization/#121-namespaces" target="_blank" rel="noopener noreferrer">here</a>. Let&#x27;s have a look at a simple example:</p>
<p>First we create the <code>.upd</code> namespace and define functions for (a table) trade and order</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q).upd.trade:{[x] `trade set x}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).upd.order:{[x] `order set x}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// We can inspect the .upd namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).upd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     | ::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trade| {[x] `trade set x}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">order| {[x] `order set x}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Since a namespace operates like a dictionary, we can leverage indexing to access the appropriate function for various tables. By providing the table name as the first parameter, we effectively index into our namespace, triggering the function and utilizing the second parameter as its input.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">q).upd[`trade;([] time:enlist .z.p; sym:`AAP; side:`buy; price:10; qty: 100)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`trade</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)trade</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">time                          sym side price qty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024.05.15D07:40:13.902355000 AAP buy  10    100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q).upd[`order;([] time:enlist .z.p; sym:`AAP; side:`buy; qty: 100)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q)order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">time                          sym side qty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024.05.15D07:40:31.927281000 AAP buy  100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="gotchas">Gotchas<a href="#gotchas" class="hash-link" aria-label="Direct link to Gotchas" title="Direct link to Gotchas">​</a></h2>
<p>While an in-depth discussion of API design best practices exceeds the scope of this blog post, I&#x27;d like to offer two crucial suggestions for creating your APIs. Firstly, simplicity is key. An API should focus on accomplishing one single task, and one single task only. You should avoid the temptation to create a &quot;solve every problem in the world API&quot;. Secondly, if your API extends beyond 10 lines of code (and indeed, in KDB/Q, 10 lines is quite substantial), consider refactoring and breaking it into smaller, more manageable functions. Additionally, it&#x27;s advisable to avoid reliance on global variables within your functions. From my experience, this often leads to bugs or, worse, production outages. Instead, if a function requires a variable, pass it as a parameter. Depending on a globally defined variable not only introduces the risk of it being undefined but also renders your API less versatile, as it cannot be reused without redefining the global variable in another process.</p>
<p><strong>That&#x27;s all folks. Happy Coding</strong></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/kdb-q">kdb/q</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/good-practice">good practice</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/software-development">software development</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/programming">programming</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/code-organisation">code organisation</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/libraries">libraries</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/Advanced KDB/Q Learning Material"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Advanced KDB/Q Learning Material</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/DefconQ at Everything, Everywhere, All with KDB/Q by Habla Computing"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">DefconQ at &#x27;Everything, Everywhere, All with KDB/Q&#x27; by Habla Computing</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Learn</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/company/defconq/" target="_blank" rel="noopener noreferrer" class="footer__link-item">DefconQ Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/alexanderunterrainer/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Alexander Unterrainer Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://defconq.myspreadshop.co.uk" target="_blank" rel="noopener noreferrer" class="footer__link-item">DefconQ Swag<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://www.youtube.com/@DefconQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube Channel<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://defconq.substack.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Newsletter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/DefconQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 DefconQ Ltd. This website is maintained by Alexander Unterrainer. Disclaimer: All content shared on this website reflect solely his personal thoughts and opinions, and is not representative of any past, current, or future employers or affiliations.</div></div></div></footer></div>
</body>
</html>